# 🧪 로그인 시스템 테스트 가이드

백엔드가 준비되지 않은 상황에서 Mock API를 사용해 로그인 시스템을 테스트하는 방법입니다.

## 🚀 테스트 실행 방법

### 1. 개발 서버 시작

```bash
cd /Users/yangjeonghwa/Desktop/project/recipot/recipot-frontend
pnpm dev:web
```

### 2. 테스트 페이지 접속

브라우저에서 다음 URL들을 차례로 테스트해보세요:

#### 메인 페이지 테스트

```
http://localhost:3000
```

- 로그아웃 상태에서는 "카카오로 로그인" 버튼이 표시됩니다
- 버튼 클릭 시 Mock API를 통해 자동으로 로그인됩니다
- 로그인 후에는 사용자 이름과 "로그아웃" 버튼이 표시됩니다

#### 종합 테스트 페이지

```
http://localhost:3000/test
```

이 페이지에서 다음을 테스트할 수 있습니다:

- ✅ Mock 로그인/로그아웃
- ✅ 토큰 검증 API
- ✅ 토큰 갱신 API
- ✅ 사용자 정보 조회 API
- ✅ 콜백 페이지 테스트

## 📋 세부 테스트 시나리오

### 시나리오 1: 기본 로그인 플로우

1. `http://localhost:3000` 접속
2. "카카오로 로그인" 버튼 클릭
3. 자동으로 Mock 사용자 (김철수)로 로그인됨
4. 상단에 "안녕하세요, 김철수님!" 메시지 확인

### 시나리오 2: 콜백 페이지 테스트

1. `http://localhost:3000/test` 접속
2. "토큰 콜백 시뮬레이션" 버튼 클릭
3. `/auth/callback` 페이지로 이동
4. "로그인 처리 중..." → "로그인 성공!" 메시지 확인
5. 자동으로 메인 페이지로 리디렉션

### 시나리오 3: API 호출 테스트

1. 먼저 로그인 완료
2. `/test` 페이지에서 각 API 버튼들을 차례로 클릭:
   - "토큰 검증" → ✅ 성공 메시지 확인
   - "토큰 갱신" → ✅ 새 토큰 생성 확인
   - "사용자 정보 조회" → ✅ 사용자 정보 반환 확인
   - "로그아웃 API" → ✅ API 호출 성공 확인

## 🔍 브라우저 개발자 도구 확인

### Network 탭

Mock API 호출을 확인할 수 있습니다:

- `/v1/login/kakao` (GET)
- `/v1/auth/verify` (POST)
- `/v1/auth/refresh` (POST)
- `/v1/auth/info/1` (GET)
- `/v1/auth/logout` (POST)

### Console 탭

다음과 같은 로그들을 확인할 수 있습니다:

```
[API Request] GET /v1/login/kakao
[API Response] 200 /v1/login/kakao
```

### Application 탭 → Local Storage

로그인 후 `authToken` 키에 Mock 토큰이 저장되는 것을 확인할 수 있습니다.

## 🐛 예상 가능한 문제와 해결법

### 문제 1: "토큰 검증에 실패했습니다" 에러

**원인**: Mock 토큰이 올바르지 않음
**해결법**:

1. localStorage를 비우고 다시 로그인
2. 토큰에 'mock_token' 문자열이 포함되어 있는지 확인

### 문제 2: Mock API가 작동하지 않음

**원인**: MSW(Mock Service Worker)가 시작되지 않음
**해결법**:

1. 브라우저 개발자 도구 Console에서 MSW 시작 메시지 확인
2. `pnpm dev:web` 재시작

### 문제 3: 페이지가 무한 로딩

**원인**: AuthContext에서 초기 토큰 검증 실패
**해결법**:

1. localStorage의 `authToken` 삭제
2. 페이지 새로고침

## 🎯 테스트 체크리스트

- [ ] 메인 페이지 로그인 버튼 동작
- [ ] 로그인 후 사용자 정보 표시
- [ ] 로그아웃 기능 동작
- [ ] 토큰 콜백 페이지 정상 동작
- [ ] 인증 코드 콜백 페이지 정상 동작
- [ ] 토큰 검증 API 호출 성공
- [ ] 토큰 갱신 API 호출 성공
- [ ] 사용자 정보 조회 API 호출 성공
- [ ] 로그아웃 API 호출 성공
- [ ] 페이지 새로고침 시 로그인 상태 유지
- [ ] LocalStorage에 토큰 저장/삭제 확인

## 📱 다음 단계

테스트가 완료되면:

1. 실제 백엔드 API 연동
2. 환경변수 `NEXT_PUBLIC_BACKEND_URL` 설정
3. 실제 카카오 OAuth 설정
4. 프로덕션 배포 테스트

모든 Mock 테스트가 통과하면 실제 백엔드와의 연동도 원활하게 진행될 것입니다! 🚀
